<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Project Calendar - Schedul...inspections, and milestones for your home improvement projects">
    <meta name="robots" content="noindex, nofollow">
    
    <title>Calendar - Project Atlas</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+x...ox='0 0 100 100'><text y='.9em' font-size='90'>üèóÔ∏è</text></svg>">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="atlas-interactive.css">

    <style>
        :root {
            --bg-primary: #f8fafc; 
            --bg-secondary: #ffffff;
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --border-default: #e2e8f0;
            --muted: #94a3b8;

            /* Blueprint-inspired blues from your design language */
            --app-primary: #1e88e5; 
            --app-primary-600: #1565C0;
            --app-primary-light: #E3F2FD;
            --app-primary-soft: #BBDEFB;

            --focus: #93c5fd;
            --success: #16a34a;
            --warning: #f59e0b;
            --danger: #ef4444;

            --radius-sm: 8px;
            --radius-md: 14px;
            --radius-lg: 18px;

            --space-xs: .375rem;   /* 6px */
            --space-sm: .5rem;     /* 8px */
            --space-md: .75rem;    /* 12px */
            --space-lg: 1rem;      /* 16px */
            --space-xl: 1.5rem;    /* 24px */

            --white: #fff;
            --black: #000;

            --shadow-sm: 0 1px 2px rgba(16, 24, 40, 0.06);
            --shadow-md: 0 6px 16px rgba(16, 24, 40, 0.12);
            --shadow-xl: 0 24px 48px rgba(16, 24, 40, 0.18);

            --status-info: #1e88e5;
            --status-success: #16a34a;
            --status-warn: #f59e0b;
            --status-error: #ef4444;

            --transition-fast: 150ms ease;
            --transition-normal: 220ms ease;
        }

        /* Page */
        body.app-page {
            background: var(--bg-primary);
            color: var(--text-primary);
        }

        /* Uniform header (shared with other pages) */
        .app-header {
            position: sticky;
            top: 0;
            z-index: 50;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-default);
        }
        .header-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: .75rem 1rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        .logo h1 {
            font-weight: 700;
            letter-spacing: .5px;
            display: flex; align-items: baseline; gap: .4rem;
        }
        .logo .atlas-blue { color: var(--app-primary); }
        .tagline { font-size: .8rem; color: var(--text-secondary); display: block; margin-top: -4px; }
        .mobile-menu-toggle {
            margin-left: auto;
            display: none;
            border: 1px solid var(--border-default);
            background: var(--bg-secondary);
            padding: .4rem .6rem;
            border-radius: var(--radius-sm);
        }
        .main-nav ul {
            display: flex;
            gap: .5rem;
            align-items: center;
        }
        .main-nav a {
            display: inline-block;
            padding: .5rem .75rem;
            border-radius: var(--radius-sm);
            color: var(--text-secondary);
            text-decoration: none;
        }
        .main-nav a.active, .main-nav a:hover {
            background: var(--app-primary-light);
            color: var(--app-primary-600);
        }
        .user-menu { display: flex; margin-left: auto; gap: .5rem; align-items: center; }
        .user-avatar {
            width: 36px; height: 36px; border-radius: 9999px;
            background: var(--app-primary-light); color: var(--app-primary-600);
            border: 1px solid var(--app-primary-soft);
        }
        .btn { font: inherit; cursor: pointer; }
        .btn.btn-secondary {
            border: 1px solid var(--border-default); background: var(--bg-secondary);
            border-radius: var(--radius-sm); padding: .4rem .75rem;
        }

        /* Calendar Page */
        main {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: var(--space-md);
            border-bottom: 1px solid var(--border-default);
            gap: var(--space-lg);
            flex-wrap: wrap;
        }

        .calendar-title h2 {
            margin-bottom: var(--space-xs);
            font-size: 1.5rem;
        }

        .current-month {
            color: var(--text-secondary);
            font-size: 0.9375rem;
        }

        .calendar-controls {
            display: flex;
            gap: var(--space-lg);
            align-items: center;
            flex-wrap: wrap;
        }

        .nav-controls {
            display: flex;
            align-items: center;
            gap: .5rem;
        }

        .btn-icon {
            border: 1px solid var(--border-default);
            background: var(--bg-secondary);
            border-radius: var(--radius-sm);
            padding: .35rem .6rem;
        }

        .filter-select {
            padding: .45rem .6rem;
            border: 1px solid var(--border-default);
            border-radius: var(--radius-sm);
            background: var(--bg-secondary);
            color: var(--text-primary);
        }
        .filter-select:focus {
            outline: none;
            border-color: var(--app-primary);
            box-shadow: 0 0 0 3px var(--app-primary-light);
        }

        .view-toggle {
            display: flex;
            border: 1px solid var(--border-default);
            border-radius: var(--radius-md);
            overflow: hidden;
        }

        .view-btn {
            padding: var(--space-sm) var(--space-md);
            background: var(--bg-secondary);
            color: var(--text-secondary);
            border: 0;
            cursor: pointer;
        }
        .view-btn.active,
        .view-btn:hover {
            background: var(--app-primary-light);
            color: var(--app-primary-600);
        }

        /* Calendar Grid */
        .calendar-container {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: var(--space-xl);
        }

        .calendar-grid {
            background: var(--bg-secondary);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            box-shadow: var(--shadow-sm);
        }

        .calendar-header-row {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            margin-bottom: var(--space-md);
            color: var(--text-secondary);
            font-size: .8rem;
        }

        .day-header {
            text-align: center;
            padding-bottom: var(--space-sm);
            border-bottom: 1px solid var(--border-default);
        }

        .calendar-day {
            min-height: 110px;
            border-radius: var(--radius-md);
            padding: .5rem;
            border: 1px dashed transparent;
        }
        .calendar-day:hover {
            border-color: var(--app-primary-light);
            background: #fbfdff;
        }

        .calendar-day.other-month {
            opacity: .45;
        }

        .calendar-day .day-number {
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: .35rem;
        }

        .event {
            margin-top: .35rem;
            background: #f8fafc;   /* do not alter palette */
            border: 1px solid var(--border-default);
            border-radius: 10px;
            padding: .35rem .5rem;
            font-size: .85rem;
            cursor: pointer;
            transition: transform .12s ease;
        }
        .event:hover { transform: translateY(-1px); }

        /* Tag colors (kept exactly as theme intent) */
        .event.kitchen { border-color: #bdd8ff; background: #f3f8ff; }
        .event.bathroom { border-color: #cfead6; background: #f4fbf6; }
        .event.basement { border-color: #ffe4b5; background: #fffaf0; }
        .event.deadline { border-color: #ffe0e0; background: #fff5f5; }

        .event .event-title {
            font-weight: 600;
        }
        .event .event-meta {
            font-size: .75rem;
            color: var(--text-secondary);
        }

        /* Sidebar */
        .calendar-sidebar {
            background: var(--bg-secondary);
            border: 1px solid var(--border-default);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            display: flex;
            flex-direction: column;
            gap: var(--space-lg);
            height: fit-content;
            position: sticky;
            top: 92px;
        }

        .calendar-sidebar h3 {
            margin-bottom: var(--space-sm);
            font-size: 1rem;
        }

        .upcoming-events .event-list {
            display: grid;
            gap: .5rem;
        }

        .upcoming-event {
            border: 1px solid var(--border-default);
            border-radius: var(--radius-md);
            padding: .5rem .6rem;
            background: #f8fafc;
            cursor: pointer;
        }
        .upcoming-event:hover {
            background: var(--app-primary-light);
            border-color: var(--app-primary-soft);
        }

        .legend .legend-list {
            display: grid;
            gap: .35rem;
        }
        .legend .legend-item {
            display: flex; gap: .5rem; align-items: center;
            font-size: .85rem; color: var(--text-secondary);
        }
        .legend .swatch {
            width: 14px; height: 14px; border-radius: 4px; border: 1px solid var(--border-default);
        }
        .legend .kitchen { background: #f3f8ff; border-color: #bdd8ff; }
        .legend .bathroom { background: #f4fbf6; border-color: #cfead6; }
        .legend .basement { background: #fffaf0; border-color: #ffe4b5; }
        .legend .deadline { background: #fff5f5; border-color: #ffe0e0; }

        .stats .stat-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: .6rem;
        }
        .stat-card {
            border: 1px solid var(--border-default);
            border-radius: 12px;
            padding: .65rem .75rem;
            background: #f9fbff;
        }
        .stat-card .label { color: var(--text-secondary); font-size: .8rem; }
        .stat-card .value { font-weight: 700; }

        .sr-only {
            position: absolute !important;
            width: 1px; height: 1px;
            padding: 0; margin: -1px;
            overflow: hidden; clip: rect(0,0,0,0);
            white-space: nowrap; border: 0;
        }

        @media (max-width: 960px) {
            .calendar-container { grid-template-columns: 1fr; }
            .mobile-menu-toggle { display: inline-flex; }
            .main-nav { display: none; }
            .main-nav.active { display: block; }
            .main-nav ul { flex-direction: column; align-items: flex-start; margin-top: .5rem; }
        }
    </style>
</head>
<body class="app-page">
    <!-- Skip to Main -->
    <a href="#main-content" class="skip-to-main">Skip to main content</a>

    <!-- Uniform Header -->
    <header class="app-header">
        <div class="header-container">
            <!-- Logo -->
            <div class="logo">
                <h1>Project <span class="atlas-blue">ATLAS</span></h1>
                <span class="tagline">Home Project Management</span>
            </div>

            <!-- Mobile Menu Toggle -->
            <button
                class="mobile-menu-toggle"
                onclick="toggleMobileMenu()"
                aria-label="Toggle navigation menu"
                aria-expanded="false"
                aria-controls="mainNav">
                <span aria-hidden="true">‚ò∞</span>
            </button>

            <!-- Main Navigation -->
            <nav class="main-nav" id="mainNav" aria-label="Main navigation">
                <ul>
                    <li><a href="dashboard.html">Dashboard</a></li>
                    <li><a href="projects.html">Projects</a></li>
                    <li><a href="kanban.html">Kanban Board</a></li>
                    <li><a href="budget.html">Budget Tracker</a></li>
                    <li><a href="calendar.html" class="active" aria-current="page">Calendar</a></li>
                    <li><a href="documents.html">Documents</a></li>
                </ul>
            </nav>

            <!-- User Menu -->
            <div class="user-menu">
                <button class="btn btn-secondary" aria-label="New Event (coming soon)" title="New Event">
                    <span aria-hidden="true">Ôºã</span>
                    New Event
                </button>

                <button class="user-avatar" onclick="showUserMenu()" aria-label="User menu" title="User Menu">
                    AF
                </button>
            </div>
        </div>
    </header>

    <main id="main-content">
        <!-- Calendar Header -->
        <div class="calendar-header" role="region" aria-label="Calendar header">
            <div class="calendar-title">
                <h2>Calendar</h2>
                <div class="current-month" aria-live="polite">November 2024</div>
            </div>

            <div class="calendar-controls">
                <!-- Left controls -->
                <div class="nav-controls" role="group" aria-label="Month navigation">
                    <button class="btn btn-icon" aria-label="Previous month" onclick="previousMonth()">‚Üê</button>
                    <button class="btn btn-icon" aria-label="Today" onclick="goToToday()">Today</button>
                    <button class="btn btn-icon" aria-label="Next month" onclick="nextMonth()">‚Üí</button>
                </div>
                
                <!-- View Controls -->
                <div class="view-controls" role="group" aria-label="View options">
                    <label for="projectFilterCalendar" class="sr-only">Filter by project</label>
                    <select class="filter-select" 
                            id="projectFilterCalendar"
                            aria-label="Filter by project"
                            onchange="handleProjectFilter(this.value)">
                    <option value="all">All Projects</option>
                    <option value="kitchen">Kitchen Renovation</option>
                    <option value="basement">Basement Finishing</option>
                    <option value="bathroom">Bathroom Update</option>
                </select>
                
                <div class="view-toggle" role="radiogroup" aria-label="Calendar view">
                    <button class="view-btn active" 
                            role="radio" 
                            aria-checked="true"
                            onclick="changeView('month')">
                   Month
                    </button>
                    <button class="view-btn" 
                            role="radio" 
                            aria-checked="false"
                            onclick="changeView('week')">
                        Week
                    </button>
                    <button class="view-btn" 
                            role="radio" 
                            aria-checked="false"
                            onclick="changeView('day')">
                        Day
                    </button>
                </div>
            </div>
        </div>

        <!-- Calendar Container -->
        <div class="calendar-container">
            <!-- Calendar Grid -->
            <section class="calendar-grid" 
                     role="grid" 
                     aria-label="November 2024 calendar"
                     aria-readonly="true">
                <!-- Day Headers -->
                <div class="calendar-header-row" role="row">
                    <div class="day-header" role="columnheader">Sun</div>
                    <div class="day-header" role="columnheader">Mon</div>
                    <div class="day-header" role="columnheader">Tue</div>
                    <div class="day-header" role="columnheader">Wed</div>
                    <div class="day-header" role="columnheader">Thu</div>
                    <div class="day-header" role="columnheader">Fri</div>
                    <div class="day-header" role="columnheader">Sat</div>
                </div>

                <!-- Week 1 -->
                <div class="calendar-day other-month" role="gridcell" aria-label="October 27" tabindex="0">
                    <div class="day-number">27</div>
                </div>
                <div class="calendar-day other-month" role="gridcell" aria-label="October 28" tabindex="0">
                    <div class="day-number">28</div>
                </div>
                <div class="calendar-day other-month" role="gridcell" aria-label="October 29" tabindex="0">
                    <div class="day-number">29</div>
                </div>
                <div class="calendar-day other-month" role="gridcell" aria-label="October 30" tabindex="0">
                    <div class="day-number">30</div>
                </div>
                <div class="calendar-day other-month" role="gridcell" aria-label="October 31" tabindex="0">
                    <div class="day-number">31</div>
                </div>
                <div class="calendar-day" role="gridcell" aria-label="November 1" tabindex="0">
                    <div class="day-number">1</div>
                </div>
                <div class="calendar-day" role="gridcell" aria-label="November 2, Material delivery" tabindex="0">
                    <div class="day-number">2</div>
                    <div class="event kitchen" 
                         role="button"
                         tabindex="0"
                         onclick="showEventDetails('evt-1')"
                         onkeypress="handleKeyPress(event, 'showEventDetails', 'evt-1')"
                         data-event-id="evt-1">
                        <div class="event-title">Material delivery</div>
                        <div class="event-meta">Kitchen ¬∑ 8:00 AM</div>
                    </div>
                </div>

                <!-- Week 2 -->
                <div class="calendar-day" role="gridcell" aria-label="November 3, Contractor meeting" tabindex="0">
                    <div class="day-number">3</div>
                    <div class="event basement" 
                         role="button"
                         tabindex="0"
                         onclick="showEventDetails('evt-2')"
                         onkeypress="handleKeyPress(event, 'showEventDetails', 'evt-2')"
                         data-event-id="evt-2">
                        <div class="event-title">Contractor meeting</div>
                        <div class="event-meta">Basement ¬∑ 9:30 AM</div>
                    </div>
                </div>
                <div class="calendar-day" role="gridcell" aria-label="November 4" tabindex="0">
                    <div class="day-number">4</div>
                </div>
                <div class="calendar-day" role="gridcell" aria-label="November 5, Plumbing inspection" tabindex="0">
                    <div class="day-number">5</div>
                    <div class="event bathroom" 
                         role="button"
                         tabindex="0"
                         onclick="showEventDetails('evt-3')"
                         onkeypress="handleKeyPress(event, 'showEventDetails', 'evt-3')"
                         data-event-id="evt-3">
                        <div class="event-title">Plumbing inspection</div>
                        <div class="event-meta">Bathroom ¬∑ 10:30 AM</div>
                    </div>
                </div>
                <div class="calendar-day" role="gridcell" aria-label="November 6" tabindex="0">
                    <div class="day-number">6</div>
                </div>
                <div class="calendar-day" role="gridcell" aria-label="November 7, Backsplash work" tabindex="0">
                    <div class="day-number">7</div>
                    <div class="event kitchen" 
                         role="button"
                         tabindex="0"
                         onclick="showEventDetails('evt-4')"
                         onkeypress="handleKeyPress(event, 'showEventDetails', 'evt-4')"
                         data-event-id="evt-4">
                        <div class="event-title">Backsplash work</div>
                        <div class="event-meta">Kitchen ¬∑ 1:00 PM</div>
                    </div>
                </div>
                <div class="calendar-day" role="gridcell" aria-label="November 8" tabindex="0">
                    <div class="day-number">8</div>
                </div>
                <div class="calendar-day" role="gridcell" aria-label="November 9" tabindex="0">
                    <div class="day-number">9</div>
                </div>

                <!-- Week 3 -->
                <div class="calendar-day" role="gridcell" aria-label="November 10, Backsplash work" tabindex="0">
                    <div class="day-number">10</div>
                    <div class="event kitchen" 
                         role="button"
                         tabindex="0"
                         onclick="showEventDetails('evt-4')"
                         onkeypress="handleKeyPress(event, 'showEventDetails', 'evt-4')"
                         data-event-id="evt-4">
                        <div class="event-title">Backsplash work</div>
                        <div class="event-meta">Kitchen ¬∑ 10:00 AM</div>
                    </div>
                </div>
                <div class="calendar-day" role="gridcell" aria-label="November 11, Permit application" tabindex="0">
                    <div class="day-number">11</div>
                    <div class="event basement" 
                         role="button"
                         tabindex="0"
                         onclick="showEventDetails('evt-5')"
                         onkeypress="handleKeyPress(event, 'showEventDetails', 'evt-5')"
                         data-event-id="evt-5">
                        <div class="event-title">Permit application</div>
                        <div class="event-meta">Basement ¬∑ 3:00 PM</div>
                    </div>
                </div>
                <div class="calendar-day" role="gridcell" aria-label="November 12" tabindex="0">
                    <div class="day-number">12</div>
                </div>
                <div class="calendar-day" role="gridcell" aria-label="November 13, Vanity installation" tabindex="0">
                    <div class="day-number">13</div>
                    <div class="event bathroom" 
                         role="button"
                         tabindex="0"
                         onclick="showEventDetails('evt-6')"
                         onkeypress="handleKeyPress(event, 'showEventDetails', 'evt-6')"
                         data-event-id="evt-6">
                        <div class="event-title">Vanity installation</div>
                        <div class="event-meta">Bathroom ¬∑ 2:00 PM</div>
                    </div>
                </div>
                <div class="calendar-day" role="gridcell" aria-label="November 14" tabindex="0">
                    <div class="day-number">14</div>
                </div>
                <div class="calendar-day" role="gridcell" aria-label="November 15, Final kitchen cleanup" tabindex="0">
                    <div class="day-number">15</div>
                    <div class="event kitchen" 
                         role="button"
                         tabindex="0"
                         onclick="showEventDetails('evt-7')"
                         onkeypress="handleKeyPress(event, 'showEventDetails', 'evt-7')"
                         data-event-id="evt-7">
                        <div class="event-title">Final kitchen cleanup</div>
                        <div class="event-meta">Kitchen ¬∑ 4:00 PM</div>
                    </div>
                </div>
                <div class="calendar-day" role="gridcell" aria-label="November 16" tabindex="0">
                    <div class="day-number">16</div>
                </div>

                <!-- Week 4 -->
                <div class="calendar-day" role="gridcell" aria-label="November 17" tabindex="0">
                    <div class="day-number">17</div>
                </div>
                <div class="calendar-day" role="gridcell" aria-label="November 18" tabindex="0">
                    <div class="day-number">18</div>
                </div>
                <div class="calendar-day" role="gridcell" aria-label="November 19, Material shopping" tabindex="0">
                    <div class="day-number">19</div>
                    <div class="event basement" 
                         role="button"
                         tabindex="0"
                         onclick="showEventDetails('evt-8')"
                         onkeypress="handleKeyPress(event, 'showEventDetails', 'evt-8')"
                         data-event-id="evt-8">
                        <div class="event-title">Material shopping</div>
                        <div class="event-meta">Basement ¬∑ 11:00 AM</div>
                    </div>
                </div>
                <div class="calendar-day" role="gridcell" aria-label="November 20" tabindex="0">
                    <div class="day-number">20</div>
                </div>
                <div class="calendar-day" role="gridcell" aria-label="November 21" tabindex="0">
                    <div class="day-number">21</div>
                </div>
                <div class="calendar-day" role="gridcell" aria-label="November 22" tabindex="0">
                    <div class="day-number">22</div>
                </div>
                <div class="calendar-day" role="gridcell" aria-label="November 23" tabindex="0">
                    <div class="day-number">23</div>
                </div>

                <!-- Week 5 -->
                <div class="calendar-day" role="gridcell" aria-label="November 24, Kitchen project deadline" tabindex="0">
                    <div class="day-number">24</div>
                    <div class="event deadline" 
                         role="button"
                         tabindex="0"
                         onclick="showEventDetails('evt-9')"
                         onkeypress="handleKeyPress(event, 'showEventDetails', 'evt-9')"
                         data-event-id="evt-9">
                        <div class="event-title">Kitchen project deadline</div>
                        <div class="event-meta">Milestone</div>
                    </div>
                </div>
                <div class="calendar-day" role="gridcell" aria-label="November 25" tabindex="0">
                    <div class="day-number">25</div>
                </div>
                <div class="calendar-day" role="gridcell" aria-label="November 26, Basement work begins" tabindex="0">
                    <div class="day-number">26</div>
                    <div class="event basement" 
                         role="button"
                         tabindex="0"
                         onclick="showEventDetails('evt-10')"
                         onkeypress="handleKeyPress(event, 'showEventDetails', 'evt-10')"
                         data-event-id="evt-10">
                        <div class="event-title">Basement work begins</div>
                        <div class="event-meta">Basement ¬∑ 9:00 AM</div>
                    </div>
                </div>
                <div class="calendar-day" role="gridcell" aria-label="November 27" tabindex="0">
                    <div class="day-number">27</div>
                </div>
                <div class="calendar-day" role="gridcell" aria-label="November 28" tabindex="0">
                    <div class="day-number">28</div>
                </div>
                <div class="calendar-day" role="gridcell" aria-label="November 29" tabindex="0">
                    <div class="day-number">29</div>
                </div>
                <div class="calendar-day" role="gridcell" aria-label="November 30" tabindex="0">
                    <div class="day-number">30</div>
                </div>
            </section>

            <!-- Calendar Sidebar -->
            <aside class="calendar-sidebar" aria-label="Calendar information">
                <!-- Upcoming Events -->
                <section class="upcoming-events" aria-labelledby="upcoming-heading">
                    <h3 id="upcoming-heading">Upcoming This Week</h3>
                    
                    <div class="event-list">
                        <article class="upcoming-event high-priority"
                                 role="button"
                                 tabindex="0"
                                 onclick="showEventDetails('evt-9')"
                                 onkeypress="handleKeyPress(event, 'showEventDetails', 'evt-9')"
                                 data-event-id="evt-9">
                            <div class="event-title">Kitchen project deadline</div>
                            <div class="event-meta">Sun, Nov 24</div>
                        </article>

                        <article class="upcoming-event"
                                 role="button"
                                 tabindex="0"
                                 onclick="showEventDetails('evt-10')"
                                 onkeypress="handleKeyPress(event, 'showEventDetails', 'evt-10')"
                                 data-event-id="evt-10">
                            <div class="event-title">Basement work begins</div>
                            <div class="event-meta">Tue, Nov 26 ‚Äì 9:00 AM</div>
                        </article>

                        <article class="upcoming-event"
                                 role="button"
                                 tabindex="0"
                                 onclick="showEventDetails('evt-6')"
                                 onkeypress="handleKeyPress(event, 'showEventDetails', 'evt-6')"
                                 data-event-id="evt-6">
                            <div class="event-title">Vanity installation</div>
                            <div class="event-meta">Wed, Nov 13 ‚Äì 2:00 PM</div>
                        </article>
                    </div>
                </section>

                <!-- Legend -->
                <section class="legend" aria-labelledby="legend-heading">
                    <h3 id="legend-heading">Legend</h3>
                    <div class="legend-list">
                        <div class="legend-item">
                            <span class="swatch kitchen" aria-hidden="true"></span>
                            <span>Kitchen Renovation</span>
                        </div>
                        <div class="legend-item">
                            <span class="swatch bathroom" aria-hidden="true"></span>
                            <span>Bathroom Update</span>
                        </div>
                        <div class="legend-item">
                            <span class="swatch basement" aria-hidden="true"></span>
                            <span>Basement Finishing</span>
                        </div>
                        <div class="legend-item">
                            <span class="swatch deadline" aria-hidden="true"></span>
                            <span>Milestone / Deadline</span>
                        </div>
                    </div>
                </section>

                <!-- Stats -->
                <section class="stats" aria-labelledby="stats-heading">
                    <h3 id="stats-heading">At a Glance</h3>
                    <div class="stat-grid">
                        <div class="stat-card">
                            <div class="label">Total Events</div>
                            <div class="value">10</div>
                        </div>
                        <div class="stat-card">
                            <div class="label">Kitchen</div>
                            <div class="value">4</div>
                        </div>
                        <div class="stat-card">
                            <div class="label">Basement</div>
                            <div class="value">3</div>
                        </div>
                    </div>
                </section>
            </aside>
        </div>
    </main>

    <script>
        // Mobile menu toggle with accessibility
        function toggleMobileMenu() {
            const nav = document.getElementById('mainNav');
            const toggle = document.querySelector('.mobile-menu-toggle');
            const isExpanded = nav.classList.toggle('active');
            
            // Update ARIA attribute
            toggle.setAttribute('aria-expanded', isExpanded);
        }
        
        // Keyboard accessibility helper
        function handleKeyPress(event, functionName, id) {
            if (event.key === 'Enter' || event.key === ' ') {
                event.preventDefault();
                if (functionName === 'showEventDetails') {
                    showEventDetails(id);
                }
            }
        }

        function buildModal(markup) {
            // Create backdrop + modal using existing app styles (no palette changes)
            const backdrop = document.createElement('div');
            backdrop.className = 'modal-backdrop show';
            const modalHost = document.createElement('div');
            modalHost.className = 'modal open';
            const panel = document.createElement('div');
            panel.className = 'modal-panel';
            panel.innerHTML = markup;
            modalHost.appendChild(panel);
            document.body.appendChild(backdrop);
            document.body.appendChild(modalHost);
            document.body.classList.add('atlas-modal-open');

            function close() {
                try {
                  document.body.removeChild(backdrop);
                  document.body.removeChild(modalHost);
                } catch(e){}
                document.body.classList.remove('atlas-modal-open');
                document.removeEventListener('keydown', onEsc);
            }
            function onEsc(e){ if(e.key === 'Escape') close(); }
            document.addEventListener('keydown', onEsc);
            backdrop.addEventListener('click', close);
            const closeBtn = panel.querySelector('[data-close]');
            if (closeBtn) closeBtn.addEventListener('click', close);
            return { close };
        }

        function readEventFromDOM(eventId) {
            const el = document.querySelector('.event[data-event-id="'+eventId+'"]');
            if (!el) return null;
            const day = el.closest('.calendar-day');
            const title = el.querySelector('.event-title')?.textContent.trim() || 'Event';
            const meta = el.querySelector('.event-meta')?.textContent.trim() || '';
            const catMatch = el.className.match(/\bevent\s+([a-z-]+)/);
            const category = catMatch ? catMatch[1] : 'general';
            const dateLabel = day?.getAttribute('aria-label') || '';
            return { id: eventId, title, meta, category, dateLabel };
        }

        function projectFromCategory(cat){
            switch(cat){
                case 'kitchen': return 'Kitchen Renovation';
                case 'bathroom': return 'Bathroom Update';
                case 'basement': return 'Basement Finishing';
                case 'deadline': return 'Milestone';
                default: return cat.charAt(0).toUpperCase()+cat.slice(1);
            }
        }

        function showEventDetails(eventId) {
            const ev = readEventFromDOM(eventId);
            if (!ev) return;
            const m = buildModal(`
                <div class="modal-header">
                  <h3 class="modal-title">${ev.title}</h3>
                  <button class="modal-close" data-close aria-label="Close">&times;</button>
                </div>
                <div class="modal-body">
                  <div class="detail-row"><strong>Date:</strong> <span>${ev.dateLabel || '‚Äî'}</span></div>
                  <div class="detail-row"><strong>Info:</strong> <span>${ev.meta || '‚Äî'}</span></div>
                  <div class="detail-row"><strong>Project:</strong> <span>${projectFromCategory(ev.category)}</span></div>
                </div>
                <div class="modal-footer">
                  <button class="btn" data-close>Close</button>
                </div>
            `);
        }

        function openDayModal(dayEl){
            const events = Array.from(dayEl.querySelectorAll('.event[data-event-id]'));
            const dayLabel = dayEl.getAttribute('aria-label') || 'Selected Day';
            if (!events.length) {
                buildModal(`
                  <div class="modal-header">
                    <h3 class="modal-title">${dayLabel}</h3>
                    <button class="modal-close" data-close aria-label="Close">&times;</button>
                  </div>
                  <div class="modal-body"><p class="text-secondary">No events for this day.</p></div>
                  <div class="modal-footer"><button class="btn" data-close>Close</button></div>
                `);
                return;
            }
            const items = events.map(e=>{
                const id = e.getAttribute('data-event-id');
                const title = e.querySelector('.event-title')?.textContent.trim() || 'Event';
                const meta = e.querySelector('.event-meta')?.textContent.trim() || '';
                return `<li><button class="btn btn-secondary" data-ev="${id}" style="width:100%; text-align:left;">${title} <span class="text-tertiary" style="float:right;">${meta}</span></button></li>`;
            }).join('');
            const { close } = buildModal(`
              <div class="modal-header">
                <h3 class="modal-title">${dayLabel}</h3>
                <button class="modal-close" data-close aria-label="Close">&times;</button>
              </div>
              <div class="modal-body">
                <ul class="modal-list" style="display:grid; gap:.5rem;">${items}</ul>
              </div>
              <div class="modal-footer"><button class="btn" data-close>Close</button></div>
            `);
            // wire item clicks
            document.querySelectorAll('[data-ev]').forEach(btn=>{
                btn.addEventListener('click', ()=>{ close(); showEventDetails(btn.getAttribute('data-ev')); });
            });
        }

        function previousMonth() {
            // keep existing UI static; provide gentle feedback without altering theme
            buildModal(`
              <div class="modal-header">
                <h3 class="modal-title">Previous Month</h3>
                <button class="modal-close" data-close aria-label="Close">&times;</button>
              </div>
              <div class="modal-body"><p class="text-secondary">Month navigation will be wired to dynamic data. Current view is November 2024.</p></div>
              <div class="modal-footer"><button class="btn" data-close>Close</button></div>
            `);
        }
        function nextMonth() {
            buildModal(`
              <div class="modal-header">
                <h3 class="modal-title">Next Month</h3>
                <button class="modal-close" data-close aria-label="Close">&times;</button>
              </div>
              <div class="modal-body"><p class="text-secondary">Month navigation will be wired to dynamic data. Current view is November 2024.</p></div>
              <div class="modal-footer"><button class="btn" data-close>Close</button></div>
            `);
        }
        function goToToday() {
            // focus the first cell with today's number if visible
            const today = new Date();
            const todayNum = String(today.getDate());
            const candidate = Array.from(document.querySelectorAll('.calendar-day:not(.other-month) .day-number'))
              .find(el => el.textContent.trim() === todayNum);
            if (candidate) { candidate.closest('.calendar-day').scrollIntoView({ behavior:'smooth', block:'center' }); candidate.closest('.calendar-day').focus(); }
            else {
              buildModal(`
                <div class="modal-header"><h3 class="modal-title">Go to Today</h3><button class="modal-close" data-close aria-label="Close">&times;</button></div>
                <div class="modal-body"><p class="text-secondary">Today is not in this static month view.</p></div>
                <div class="modal-footer"><button class="btn" data-close>Close</button></div>
              `);
            }
        }

        function changeView(view) {
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.classList.toggle('active', btn.textContent.trim().toLowerCase() === view);
                btn.setAttribute('aria-checked', String(btn.classList.contains('active')));
            });
            if (view !== 'month') {
                buildModal(`
                  <div class="modal-header"><h3 class="modal-title">Coming Soon</h3><button class="modal-close" data-close aria-label="Close">&times;</button></div>
                  <div class="modal-body"><p class="text-secondary">Week and Day views will respect your existing color palette.</p></div>
                  <div class="modal-footer"><button class="btn" data-close>Close</button></div>
                `);
            }
        }

        function handleProjectFilter(value) {
            const events = document.querySelectorAll('.calendar-day .event[data-event-id]');
            events.forEach(el => {
                const cat = (el.className.match(/\bevent\s+([a-z-]+)/) || [, ''])[1];
                const show = value==='all' || value===cat || (value==='kitchen' && cat==='deadline');
                el.style.display = show ? '' : 'none';
            });
            // dim empty days (without changing theme)
            document.querySelectorAll('.calendar-day').forEach(day=>{
                const visible = Array.from(day.querySelectorAll('.event[data-event-id]')).some(e=>e.style.display!=='none');
                day.style.opacity = visible || day.classList.contains('other-month') ? '' : '0.6';
            });
        }

        // Enhance day cells for click-to-open
        document.querySelectorAll('.calendar-day[role="gridcell"]').forEach(cell=>{
            cell.addEventListener('click', (e)=>{
                if (e.target.closest('.event')) return; // event handled separately
                openDayModal(cell);
            });
            cell.addEventListener('keydown', (e)=>{
                if (e.key==='Enter') {
                    if (cell.querySelector('.event[data-event-id]')) openDayModal(cell);
                }
            });
        });

        function showUserMenu() {
            // Implementation (consistent across pages) is in atlas-interactive.js
            if (window.atlas && typeof window.atlas.showUserMenu === 'function') {
              window.atlas.showUserMenu();
            }
        }

        // Close mobile menu with ESC
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                const nav = document.getElementById('mainNav');
                if (nav.classList.contains('active')) {
                    toggleMobileMenu();
                }
            }
        });
    </script>
    
    <!-- Main Interactive Script -->
    <script src="atlas-interactive.js"></script>
</body>
</html>
